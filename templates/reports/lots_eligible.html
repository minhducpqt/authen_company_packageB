{% extends "base.html" %}
{% block title %}Lô đủ điều kiện{% endblock %}
{% block content %}
{% set export_kind = "lots_eligible" %}
{% include "reports/_toolbar.html" %}
<div class="bg-white rounded-xl border">
  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead class="bg-slate-50 text-slate-500">
        <tr>
          <th class="th">Dự án</th>
          <th class="th">Mã lô</th>
          <th class="th text-right">Giá khởi điểm</th>
          <th class="th">Trạng thái ĐK</th>
          <th class="th">Khách đặt cọc (đủ ĐK)</th>
        </tr>
      </thead>
      <tbody class="divide-y">
      {% for row in (data.rows or []) %}
        <tr>
          <td class="td">{{ row.project_code }}</td>
          <td class="td font-medium">{{ row.lot_code }}</td>
          <td class="td text-right">{{ row.starting_price_vnd | default(0) | int }}</td>
          <td class="td">{{ row.eligibility_status }}</td>
          <td class="td">
            {% if row.deposited_customers and row.deposited_customers|length > 0 %}
              <ul class="list-disc ml-5">
              {% for c in row.deposited_customers %}
                <li>{{ c.full_name }} — {{ c.phone }} ({{ c.deposit_paid_vnd | int }})</li>
              {% endfor %}
              </ul>
            {% else %}
              <span class="text-slate-400">—</span>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
      {% if not data.rows or data.rows|length == 0 %}
        <tr><td class="td text-slate-400" colspan="5">Không có dữ liệu.</td></tr>
      {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
