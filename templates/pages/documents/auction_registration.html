<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>Đơn đăng ký tham gia đấu giá tài sản</title>
  <style>
    @page { size: A4; margin: 18mm 16mm; }
    html, body {
      font-family: "Times New Roman", Times, serif;
      font-size: 13pt;
      color: #000;
    }
    .center { text-align: center; }
    .bold { font-weight: 700; }
    .mt-6 { margin-top: 6mm; }
    .mb-4 { margin-bottom: 4mm; }
    .mb-6 { margin-bottom: 6mm; }
    .underline { text-decoration: underline; }
    .divider { text-align:center; margin: 2mm 0 6mm; }
    .row { display: flex; align-items: baseline; gap: 6mm; }
    .label { min-width: 38mm; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #000; padding: 4px 6px; vertical-align: top; }
    th { text-align: center; }
    .w-stt   { width: 10mm; }
    .w-name  { width: auto; }
    .w-area  { width: 28mm; text-align: right; }
    .w-price { width: 42mm; text-align: right; }
    .signature { width: 60%; margin-left: auto; text-align: center; }
    .note { font-style: italic; font-size: 11pt; }
    .small { font-size: 11.5pt; }
    .title { font-size: 18pt; font-weight: 800; text-transform: uppercase; }
    .gov   { font-size: 16pt; font-weight: 800; text-transform: uppercase; }
  </style>
</head>
<body>

  <div class="center gov">CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</div>
  <div class="center bold">Độc lập – Tự do – Hạnh phúc</div>
  <div class="divider">-----------------o0o-----------------</div>

  <div class="center title mb-6">ĐƠN ĐĂNG KÝ THAM GIA ĐẤU GIÁ TÀI SẢN</div>

  <div class="mb-6">
    <span class="bold">Kính gửi:</span>
    {{ (data.company or {}).name or "" }}
  </div>

  <div class="row mb-4">
    <div class="label bold">Người đăng ký TGĐG:</div>
    <div class="flex-1 underline" style="flex:1">
      {{ (data.customer or {}).full_name or "" }}
    </div>
    <div class="label bold" style="margin-left:6mm">SĐT:</div>
    <div class="underline" style="min-width:40mm">
      {{ (data.customer or {}).phone or "" }}
    </div>
  </div>

  <div class="row mb-4">
    <div class="label bold">CCCD/CC số:</div>
    <div class="underline" style="flex:1">
      {{ (data.customer or {}).cccd or "" }}
    </div>
    <div class="label bold" style="margin-left:6mm">Email:</div>
    <div class="underline" style="min-width:55mm">
      {{ (data.customer or {}).email or "" }}
    </div>
  </div>

  <div class="row mb-6">
    <div class="label bold">Nơi thường trú:</div>
    <div class="underline" style="flex:1">
      {{ (data.customer or {}).address or "" }}
    </div>
  </div>

  <div class="mb-4 small">
    <span class="bold">Tài sản đấu giá:</span>
    Quyền sử dụng đất thuộc dự án
    <span class="bold">{{ (data.project or {}).name or "" }}</span>.
  </div>

  {# Chuẩn hoá danh sách lô #}
  {% set lots = data.lots or [] %}

  <table class="mb-6">
    <thead>
      <tr>
        <th class="w-stt">STT</th>
        <th class="w-name">Tên lô / thửa đất</th>
        <th class="w-area">Diện tích (m²)</th>
        <th class="w-price">Giá khởi điểm (VND)</th>
      </tr>
    </thead>
    <tbody>
      {% for lot in lots %}
        {# Mã lô: ưu tiên lot_code, fallback lot_number #}
        {% if 'lot_code' in lot %}
          {% set lot_code = lot.lot_code %}
        {% elif 'lot_number' in lot %}
          {% set lot_code = lot.lot_number %}
        {% else %}
          {% set lot_code = '' %}
        {% endif %}

        {# Diện tích #}
        {% if 'area_m2' in lot %}
          {% set area = lot.area_m2 %}
        {% else %}
          {% set area = None %}
        {% endif %}

        {# Giá khởi điểm:
           - ưu tiên starting_price_vnd
           - nếu không có thì dùng reserve_price_vnd (nếu A bổ sung sau này)
           - cuối cùng fallback deposit_amount_vnd để khỏi bị trống #}
        {% if 'starting_price_vnd' in lot and lot.starting_price_vnd is not none %}
          {% set price = lot.starting_price_vnd %}
        {% elif 'reserve_price_vnd' in lot and lot.reserve_price_vnd is not none %}
          {% set price = lot.reserve_price_vnd %}
        {% elif 'deposit_amount_vnd' in lot and lot.deposit_amount_vnd is not none %}
          {% set price = lot.deposit_amount_vnd %}
        {% else %}
          {% set price = None %}
        {% endif %}

        <tr>
          <td class="center">{{ loop.index }}</td>
          <td>{{ lot_code }}</td>
          <td class="w-area">
            {% if area is not none %}
              {{ "{:,.2f}".format(area|float) }}
            {% endif %}
          </td>
          <td class="w-price">
            {% if price is not none %}
              {{ "{:,.0f}".format(price|float) }}
            {% endif %}
          </td>
        </tr>
      {% endfor %}

      {% if lots|length == 0 %}
      <tr>
        <td class="center">1</td>
        <td>&nbsp;</td>
        <td class="w-area"></td>
        <td class="w-price"></td>
      </tr>
      {% endif %}
    </tbody>
  </table>

  {# Nếu muốn in thêm tài khoản hoàn cọc ở cuối đơn (optional) #}
  {% if data.refund_bank %}
    <div class="small mb-6">
      <span class="bold">Tài khoản nhận hoàn tiền đặt trước (nếu không trúng đấu giá):</span><br>
      Ngân hàng: {{ data.refund_bank.bank_name or data.refund_bank.bank_short_name or data.refund_bank.bank_code }}<br>
      Số tài khoản: {{ data.refund_bank.account_number }}<br>
      Chủ tài khoản: {{ data.refund_bank.account_name }}
    </div>
  {% endif %}

  <div class="bold mb-4">Tôi xin cam kết:</div>
  <ol class="small mb-6" style="margin-top:0;">
    <li>Tôi là người duy nhất đại diện cho hộ gia đình đăng ký tham gia đấu giá lô/thửa đất trên và không thuộc trường hợp không đủ điều kiện đăng ký tham gia đấu giá theo Luật ĐGTS.</li>
    <li>Đã xem tài sản đấu giá, xem giấy tờ về quyền sở hữu, sử dụng tài sản trên. Đã nhận, đọc và hiểu rõ nội dung tại Thông báo đấu giá tài sản và Quy chế đấu giá tài sản của Công ty; tự nguyện đăng ký tham gia đấu giá tại phiên nêu trên.</li>
    <li>Chấp nhận tham gia đấu giá theo hình thức, điều kiện mà Công ty lựa chọn cho phiên đấu giá.</li>
    <li>Khi tham gia đấu giá, tôi cam kết thực hiện đúng Quy chế đấu giá tài sản mà Công ty đã ban hành và các quy định pháp luật có liên quan đến việc bán đấu giá tài sản.</li>
    <li>Không nhận tiền lãi phát sinh của khoản tiền đặt trước (nếu có).</li>
  </ol>

  <div class="signature">
    <div>…, ngày …. tháng … năm {{ year }}</div>
    <div class="bold">Người đăng ký tham gia đấu giá</div>
    <div class="note">(Ký, ghi rõ họ tên)</div>
  </div>

</body>
</html>
